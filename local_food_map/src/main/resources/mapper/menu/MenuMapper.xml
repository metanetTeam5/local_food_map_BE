<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.metanet.amatmu.menu.dao.MenuRepository">

    <!-- 메뉴 목록 조회 -->
    <select id="getMenuList" resultType="com.metanet.amatmu.menu.dto.MenuDTO">
        SELECT * FROM menu WHERE rest_id = #{restId}
    </select>

    <!-- 메뉴 삽입 -->
    <insert id="insertMenu">
        INSERT INTO menu (rest_id, name, description, price, ...)
        VALUES (#{member.id}, #{menuDTO.name}, #{menuDTO.description}, #{menuDTO.price}, ...)
    </insert>

    <!-- 메뉴 업데이트 -->
    <update id="updateMenu">
        UPDATE menu
        SET name = #{menuDTO.name},
            description = #{menuDTO.description},
            price = #{menuDTO.price},
            ...
        WHERE id = #{menuDTO.id} AND rest_id = #{member.id}
    </update>

    <!-- 메뉴 삭제 -->
    <delete id="deleteMenu">
        DELETE FROM menu WHERE id = #{menuDTO.id} AND rest_id = #{member.id}
    </delete>

    <!-- 추천 메뉴 유형 조회 -->
    <select id="getRecommendedMenuTypes" resultType="String">
        SELECT type FROM menu GROUP BY type ORDER BY COUNT(*) DESC LIMIT 10
    </select>

</mapper>
